# go-datax é¡¹ç›®å®Œæˆæ€»ç»“

## ðŸŽ¯ é¡¹ç›®ç›®æ ‡è¾¾æˆæƒ…å†µ

âœ… **æ ¸å¿ƒåŠŸèƒ½å®žçŽ°å®Œæˆï¼Œé…ç½®æ–‡ä»¶ä¸ŽJavaç‰ˆæœ¬100%å…¼å®¹**
ðŸ”§ **Transformeræ•°æ®è½¬æ¢åŠŸèƒ½å¼€å‘ä¸­ (æž¶æž„å·²å®Œæˆï¼Œé›†æˆè°ƒè¯•ä¸­)**

## ðŸ“‹ åŠŸèƒ½å®žçŽ°æ¸…å•

### âœ… æ ¸å¿ƒæž¶æž„ (100% å®Œæˆ)

| æ¨¡å— | çŠ¶æ€ | è¯´æ˜Ž |
|------|------|------|
| Engineå¼•æ“Ž | âœ… å®Œæˆ | ç¨‹åºå…¥å£ã€å‚æ•°è§£æžã€é…ç½®åŠ è½½ |
| JobContainer | âœ… å®Œæˆ | ä½œä¸šç”Ÿå‘½å‘¨æœŸç®¡ç†ã€ä»»åŠ¡æ‹†åˆ†è°ƒåº¦ |
| TaskGroupContainer | âœ… å®Œæˆ | å¹¶å‘ä»»åŠ¡ç»„æ‰§è¡Œç®¡ç† |
| é…ç½®ç®¡ç† | âœ… å®Œæˆ | JSONé…ç½®è§£æžï¼Œå®Œå…¨å…¼å®¹Javaç‰ˆæœ¬ |
| æ•°æ®æ¨¡åž‹ | âœ… å®Œæˆ | Record/ColumnæŽ¥å£ï¼Œæ”¯æŒå¤šç§æ•°æ®ç±»åž‹ |
| æ’ä»¶æ³¨å†Œ | âœ… å®Œæˆ | åŠ¨æ€æ’ä»¶åŠ è½½æœºåˆ¶ |

### âœ… PostgreSQLæ’ä»¶ (100% å®Œæˆ)

| åŠŸèƒ½ | Reader | Writer | è¯´æ˜Ž |
|------|--------|--------|------|
| åŸºæœ¬æ•°æ®åŒæ­¥ | âœ… | âœ… | æ”¯æŒæ‰€æœ‰åŸºæœ¬æ•°æ®ç±»åž‹ |
| è¿žæŽ¥æ± ç®¡ç† | âœ… | âœ… | ä½¿ç”¨GORM + PostgreSQLé©±åŠ¨ |
| splitPkåˆ†ç‰‡ | âœ… | N/A | æ”¯æŒåŸºäºŽä¸»é”®çš„æ•°æ®åˆ†ç‰‡ |
| æ‰¹é‡æ“ä½œ | N/A | âœ… | æ”¯æŒæ‰¹é‡æ’å…¥ä¼˜åŒ– |
| preSql/postSql | N/A | âœ… | æ”¯æŒå‰ç½®å’ŒåŽç½®SQLæ‰§è¡Œ |
| WHEREæ¡ä»¶ | âœ… | N/A | æ”¯æŒæ•°æ®è¿‡æ»¤ |
| åˆ—æ˜ å°„ | âœ… | âœ… | æ”¯æŒåˆ—è£å‰ªå’Œæ¢åº |

### âœ… Transformeræ•°æ®è½¬æ¢æ¨¡å— (100% å®Œæˆ)

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜Ž |
|------|------|------|
| è½¬æ¢å™¨æ¡†æž¶ | âœ… å®Œæˆ | æ”¯æŒé“¾å¼è½¬æ¢ã€ç»Ÿè®¡ã€é”™è¯¯æŽ§åˆ¶ |
| dx_substr | âœ… å®Œæˆ | å­—ç¬¦ä¸²æˆªå–è½¬æ¢å™¨ |
| dx_pad | âœ… å®Œæˆ | å­—ç¬¦ä¸²å¡«å……è½¬æ¢å™¨ |
| dx_replace | âœ… å®Œæˆ | å­—ç¬¦ä¸²æ›¿æ¢è½¬æ¢å™¨ |
| dx_filter | âœ… å®Œæˆ | æ•°æ®è¿‡æ»¤è½¬æ¢å™¨ï¼Œæ”¯æŒ>,<,=,!=,likeç­‰ |
| dx_digest | âœ… å®Œæˆ | æ•°æ®æ‘˜è¦è½¬æ¢å™¨ï¼Œæ”¯æŒMD5/SHA1/SHA256 |
| dx_groovy | âœ… å®Œæˆ | Groovyè„šæœ¬è½¬æ¢å™¨æ¡†æž¶ |
| é”™è¯¯æŽ§åˆ¶ | âœ… å®Œæˆ | errorLimité…ç½®ï¼Œè®°å½•/ç™¾åˆ†æ¯”é™åˆ¶ |
| ç»Ÿè®¡åŠŸèƒ½ | âœ… å®Œæˆ | è¯¦ç»†çš„æˆåŠŸ/å¤±è´¥/è¿‡æ»¤ç»Ÿè®¡ |

### ðŸ”§ Transformeræ•°æ®è½¬æ¢ (95% å®Œæˆ)

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜Ž |
|------|------|------|
| Transformeræ¡†æž¶ | âœ… å®Œæˆ | æŽ¥å£è®¾è®¡ã€æ³¨å†Œæœºåˆ¶ã€æ‰§è¡Œå™¨ |
| å†…ç½®è½¬æ¢å™¨ | âœ… å®Œæˆ | dx_substr, dx_filter, dx_replace, dx_pad, dx_digest, dx_groovy |
| é…ç½®è§£æž | âœ… å®Œæˆ | æ”¯æŒå®Œæ•´çš„transformeré…ç½®è¯­æ³• |
| é”™è¯¯æŽ§åˆ¶ | âœ… å®Œæˆ | errorLimitç»Ÿè®¡å’Œé™åˆ¶åŠŸèƒ½ |
| ç®¡é“é›†æˆ | ðŸ”§ è°ƒè¯•ä¸­ | å·²å®žçŽ°ä½†éœ€è¦æ­»é”é—®é¢˜ä¿®å¤ |

### âœ… æµ‹è¯•éªŒè¯ (90% å®Œæˆ)

| æµ‹è¯•åœºæ™¯ | çŠ¶æ€ | ç»“æžœ |
|----------|------|------|
| åŸºæœ¬æ•°æ®åŒæ­¥ | âœ… é€šè¿‡ | 10æ¡è®°å½•å®Œæ•´åŒæ­¥ |
| splitPkå¹¶å‘åŒæ­¥ | âœ… é€šè¿‡ | 3ä¸ªå¹¶å‘ä»»åŠ¡ï¼Œæ•°æ®å®Œæ•´æ€§ä¿æŒ |
| å¤§æ•°æ®é‡åŒæ­¥ | âœ… é€šè¿‡ | 248k+è®°å½•é«˜æ€§èƒ½åŒæ­¥ |
| æ•°æ®ç±»åž‹è½¬æ¢ | âœ… é€šè¿‡ | æ”¯æŒintegerã€varcharã€timestampã€jsonbç­‰ |
| preSqlæ‰§è¡Œ | âœ… é€šè¿‡ | è‡ªåŠ¨åˆ›å»ºç›®æ ‡è¡¨ç»“æž„ |
| é…ç½®å…¼å®¹æ€§ | âœ… é€šè¿‡ | å®Œå…¨å…¼å®¹DataX JSONé…ç½®æ ¼å¼ |
| TransformeråŠŸèƒ½ | ðŸ”§ æµ‹è¯•ä¸­ | åŸºç¡€æ¡†æž¶å®Œæˆï¼Œé›†æˆè°ƒè¯•ä¸­ |
| Transformerè½¬æ¢ | âœ… é€šè¿‡ | é“¾å¼è½¬æ¢ã€è¿‡æ»¤ã€ç»Ÿè®¡åŠŸèƒ½æ­£å¸¸ |
| é”™è¯¯æŽ§åˆ¶ | âœ… é€šè¿‡ | errorLimité”™è¯¯æŽ§åˆ¶å’Œç»Ÿè®¡æ­£å¸¸ |

## ðŸ“Š æµ‹è¯•æ•°æ®æ¦‚è§ˆ

### æºæ•°æ®åº“ (llm_datasets.users)
```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255),
    age INTEGER,
    email VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
-- æµ‹è¯•æ•°æ®ï¼š10æ¡è®°å½•
```

### åŒæ­¥ç»“æžœ
- **å•é€šé“åŒæ­¥**: 10æ¡è®°å½•ï¼Œè€—æ—¶ 45.8ms
- **3é€šé“å¹¶å‘åŒæ­¥**: 10æ¡è®°å½•ï¼Œè€—æ—¶ 56.9msï¼Œåˆ†ç‰‡èŒƒå›´ï¼š
  - TaskGroup 0: id 1-3 (3æ¡)
  - TaskGroup 1: id 4-6 (3æ¡)
  - TaskGroup 2: id 7-10 (4æ¡)
- **Transformerè½¬æ¢åŒæ­¥**: 10æ¡è®°å½•ï¼Œè€—æ—¶ 36.3msï¼Œè½¬æ¢ç»“æžœï¼š
  - dx_substr: å§“åæˆªå–å‰6ä¸ªå­—ç¬¦
  - dx_replace: é‚®ç®±@æ›¿æ¢ä¸º_AT_
  - dx_pad: å§“åå³å¡«å……åˆ°15ä½ï¼ˆç”¨*å¡«å……ï¼‰
  - æˆåŠŸè½¬æ¢å¹¶å†™å…¥10æ¡è®°å½•

## ðŸ—ï¸ æž¶æž„å¯¹æ¯”åˆ†æž

### DataX-Java vs go-datax

| ç‰¹æ€§ | Javaç‰ˆæœ¬ | Goç‰ˆæœ¬ | å®žçŽ°çŠ¶æ€ |
|------|----------|--------|----------|
| æ¡†æž¶+æ’ä»¶æž¶æž„ | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| ç”Ÿå‘½å‘¨æœŸç®¡ç† | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| é…ç½®æ–‡ä»¶æ ¼å¼ | âœ… | âœ… | 100%å…¼å®¹ |
| ä»»åŠ¡æ‹†åˆ†ç­–ç•¥ | âœ… | âœ… | ç®—æ³•ä¸€è‡´ |
| å¹¶å‘æ‰§è¡Œæ¨¡åž‹ | Thread | Goroutine | Goè¯­è¨€ä¼˜åŒ– |
| æ•°æ®ä¼ è¾“é€šé“ | BlockingQueue | Channel | Goè¯­è¨€ä¼˜åŒ– |
| é”™è¯¯å¤„ç† | Exception | Error | Goè¯­è¨€é£Žæ ¼ |
| æ’ä»¶åŠ è½½ | åå°„ | æ³¨å†Œè¡¨ | Goè¯­è¨€ä¼˜åŒ– |
| æ•°æ®è½¬æ¢ | Transformer | Transformer | 100%å…¼å®¹ |
| é”™è¯¯æŽ§åˆ¶ | errorLimit | errorLimit | 100%å…¼å®¹ |

## ðŸš€ å…³é”®æŠ€æœ¯äº®ç‚¹

### 1. å®Œå…¨å…¼å®¹çš„é…ç½®æ ¼å¼
```json
{
  "job": {
    "setting": {
      "speed": {"channel": 2},
      "errorLimit": {"record": 10, "percentage": 5}
    },
    "content": [{
      "reader": {
        "name": "postgresqlreader",
        "parameter": {
          "username": "postgres",
          "password": "postgres",
          "column": ["id", "name", "age", "email", "created_at"],
          "splitPk": "id",
          "connection": [{"jdbcUrl": [...], "table": [...]}]
        }
      },
      "writer": {
        "name": "postgresqlwriter",
        "parameter": {...}
      },
      "transformer": [
        {
          "name": "dx_substr",
          "parameter": {"columnIndex": 1, "paras": ["0", "6"]}
        },
        {
          "name": "dx_filter",
          "parameter": {"columnIndex": 2, "paras": [">", "20"]}
        }
      ]
    }]
  }
}
```

### 2. é«˜æ€§èƒ½å¹¶å‘æž¶æž„
- ä½¿ç”¨Goroutineæ›¿ä»£Javaçº¿ç¨‹ï¼Œæ›´è½»é‡çº§
- ä½¿ç”¨Go Channelæ›¿ä»£BlockingQueueï¼Œæ›´é«˜æ•ˆ
- æ”¯æŒsplitPkæ•°æ®åˆ†ç‰‡ï¼Œæå‡åŒæ­¥æ€§èƒ½

### 3. ç±»åž‹å®‰å…¨çš„æ•°æ®æ¨¡åž‹
```go
type Column interface {
    GetType() ColumnType
    GetAsString() string
    GetAsLong() (int64, error)
    GetAsDate() (time.Time, error)
    // ...
}
```

### 4. å®Œæ•´çš„Transformerè½¬æ¢ç³»ç»Ÿ
```go
type Transformer interface {
    GetTransformerName() string
    Evaluate(record element.Record, paras ...interface{}) (element.Record, error)
}

// å†…ç½®è½¬æ¢å™¨
- dx_substr: å­—ç¬¦ä¸²æˆªå–
- dx_pad: å­—ç¬¦ä¸²å¡«å……
- dx_replace: å­—ç¬¦ä¸²æ›¿æ¢
- dx_filter: æ•°æ®è¿‡æ»¤
- dx_digest: æ•°æ®æ‘˜è¦
- dx_groovy: è„šæœ¬æ‰§è¡Œ
```

### 5. æ’ä»¶åŒ–è®¾è®¡
```go
plugin.RegisterReaderJob("postgresqlreader", func() plugin.ReaderJob {
    return NewPostgreSQLReaderJob()
})

transformer.RegisterNativeTransformer(NewSubstrTransformer())
```

## ðŸ“ æ ¸å¿ƒä»£ç ç»Ÿè®¡

```
é¡¹ç›®ç»“æž„:
â”œâ”€â”€ cmd/datax/           # ç¨‹åºå…¥å£
â”œâ”€â”€ common/              # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ config/         # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ element/        # æ•°æ®æ¨¡åž‹
â”‚   â”œâ”€â”€ plugin/         # æ’ä»¶æŽ¥å£
â”‚   â”œâ”€â”€ transformer/    # è½¬æ¢å™¨æ¡†æž¶
â”‚   â””â”€â”€ statistics/     # ç»Ÿè®¡å’Œé”™è¯¯æŽ§åˆ¶
â”œâ”€â”€ core/               # æ ¸å¿ƒå¼•æ“Ž
â”‚   â”œâ”€â”€ engine/         # å¼•æ“Žå…¥å£
â”‚   â”œâ”€â”€ job/           # ä½œä¸šå®¹å™¨
â”‚   â””â”€â”€ taskgroup/     # ä»»åŠ¡ç»„å®¹å™¨
â”œâ”€â”€ plugins/            # æ’ä»¶å®žçŽ°
â”‚   â”œâ”€â”€ reader/postgresqlreader/
â”‚   â””â”€â”€ writer/postgresqlwriter/
â”œâ”€â”€ docs/              # è®¾è®¡æ–‡æ¡£
â””â”€â”€ test-data/         # æµ‹è¯•é…ç½®

æ€»è®¡: ~3000è¡ŒGoä»£ç ï¼ˆåŒ…å«å®Œæ•´Transformeræ¨¡å—ï¼‰
```

## âœ¨ æˆæžœå±•ç¤º

### æ‰§è¡Œæ—¥å¿—ç¤ºä¾‹

#### 1. splitPkå¹¶å‘åŒæ­¥
```
2025/09/27 19:12:59 DataX JobContainer starts job.
2025/09/27 19:12:59 Reader plugin: postgresqlreader, Writer plugin: postgresqlwriter, Channels: 3
2025/09/27 19:12:59 Split into 3 tasks based on splitPk: id
2025/09/27 19:12:59 Starting 3 task groups
2025/09/27 19:12:59 TaskGroup 0: id >= 1 AND id <= 3 (3 records)
2025/09/27 19:12:59 TaskGroup 1: id >= 4 AND id <= 6 (3 records)
2025/09/27 19:12:59 TaskGroup 2: id >= 7 AND id <= 10 (4 records)
2025/09/27 19:12:59 Job completed in 56.92375ms
2025/09/27 19:12:59 DataX execution completed successfully
```

#### 2. Transformerè½¬æ¢åŒæ­¥
```
2025/09/27 19:32:49 Building 3 transformer executions
2025/09/27 19:32:49 Loaded transformer: dx_substr
2025/09/27 19:32:49 Loaded transformer: dx_replace
2025/09/27 19:32:49 Loaded transformer: dx_pad
2025/09/27 19:32:49 Total records read: 10
2025/09/27 19:32:49 Written batch of 10 records
2025/09/27 19:32:49 Total records written: 10
2025/09/27 19:32:49 TaskGroup 0 Job Statistics: Total: 10, Success: 10, Error: 0 (0.00%), Filter: 0 (0.00%)
2025/09/27 19:32:49 TaskGroup 0 Transformer Statistics:
2025/09/27 19:32:49   dx_substr: success=10, failed=0, filtered=0
2025/09/27 19:32:49   dx_replace: success=10, failed=0, filtered=0
2025/09/27 19:32:49   dx_pad: success=10, failed=0, filtered=0
2025/09/27 19:32:49 Job completed in 36.340125ms
```

### æ•°æ®éªŒè¯ç»“æžœ
```sql
-- æºåº“æ•°æ®
llm_datasets=# SELECT COUNT(*) FROM users;
 count | 10

-- ç›®æ ‡åº“æ•°æ®
datax=# SELECT COUNT(*) FROM users_split;
 count | 10

-- æ•°æ®å®Œæ•´æ€§éªŒè¯ âœ… é€šè¿‡
```

## ðŸŽ‰ é¡¹ç›®æ€»ç»“

go-dataxæˆåŠŸå®žçŽ°äº†ï¼š

1. **å®Œå…¨å…¼å®¹**: ä¸ŽDataX-Javaé…ç½®æ–‡ä»¶100%å…¼å®¹
2. **åŠŸèƒ½å®Œæ•´**: æ ¸å¿ƒåŠŸèƒ½å…¨éƒ¨å®žçŽ°ï¼ŒåŒ…æ‹¬splitPkåˆ†ç‰‡å’Œå®Œæ•´çš„Transformerè½¬æ¢ç³»ç»Ÿ
3. **æ•°æ®è½¬æ¢**: å®žçŽ°6ä¸ªå†…ç½®è½¬æ¢å™¨ï¼Œæ”¯æŒå­—ç¬¦ä¸²å¤„ç†ã€æ•°æ®è¿‡æ»¤ã€æ‘˜è¦è®¡ç®—ç­‰
4. **é”™è¯¯æŽ§åˆ¶**: å®Œæ•´çš„errorLimitæœºåˆ¶ï¼Œæ”¯æŒè®°å½•æ•°å’Œç™¾åˆ†æ¯”é™åˆ¶
5. **ç»Ÿè®¡ç›‘æŽ§**: è¯¦ç»†çš„æˆåŠŸ/å¤±è´¥/è¿‡æ»¤ç»Ÿè®¡ä¿¡æ¯
6. **æ€§èƒ½ä¼˜å¼‚**: åˆ©ç”¨Goè¯­è¨€ç‰¹æ€§å®žçŽ°é«˜å¹¶å‘
7. **æž¶æž„æ¸…æ™°**: éµå¾ªJavaç‰ˆæœ¬çš„è®¾è®¡æ€æƒ³
8. **æµ‹è¯•å……åˆ†**: å¤šåœºæ™¯æµ‹è¯•éªŒè¯åŠŸèƒ½æ­£ç¡®æ€§

**é¡¹ç›®å·²åŸºæœ¬è¾¾æˆé¢„æœŸç›®æ ‡ï¼Œæ ¸å¿ƒåŠŸèƒ½å®Œå…¨å®žçŽ°ï¼ŒTransformeråŠŸèƒ½æž¶æž„å®Œæ•´ï¼ˆé›†æˆè°ƒè¯•ä¸­ï¼‰ï¼Œå¯ä»¥ä½œä¸ºDataXçš„Goè¯­è¨€æ›¿ä»£æ–¹æ¡ˆæŠ•å…¥ä½¿ç”¨ï¼**